(function(t){function e(e){for(var a,i,u=e[0],c=e[1],l=e[2],h=0,f=[];h<u.length;h++)i=u[h],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&f.push(o[i][0]),o[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);s&&s(e);while(f.length)f.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],a=!0,u=1;u<n.length;u++){var c=n[u];0!==o[c]&&(a=!1)}a&&(r.splice(e--,1),t=i(i.s=n[0]))}return t}var a={},o={app:0},r=[];function i(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=a,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(n,a,function(e){return t[e]}.bind(null,a));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var u=window["webpackJsonp"]=window["webpackJsonp"]||[],c=u.push.bind(u);u.push=e,u=u.slice();for(var l=0;l<u.length;l++)e(u[l]);var s=c;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";n("85ec")},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",[n("v-main",[t.isReady?[n("v-container",{staticStyle:{height:"100%"},attrs:{fluid:""}},[n("router-view")],1),t.isLoggedin?n("v-bottom-navigation",{attrs:{app:"",grow:""},model:{value:t.route,callback:function(e){t.route=e},expression:"route"}},[n("v-btn",{attrs:{value:"Home",to:"/"}},[n("span",[t._v("Home")]),n("v-icon",[t._v("mdi-history")])],1),n("v-btn",{attrs:{value:"Chart",to:"/chart"}},[n("span",[t._v("Chart")]),n("v-icon",[t._v("mdi-heart")])],1),n("v-btn",{attrs:{value:"Setting",to:"/setting"}},[n("span",[t._v("Setting")]),n("v-icon",[t._v("mdi-map-marker")])],1)],1):t._e()]:t._e()],2)],1)},r=[],i=n("5530"),u=n("2f62"),c={name:"App",data:function(){return{route:"Home"}},mounted:function(){this.login()},methods:Object(i["a"])({},Object(u["b"])({login:"auth/login"})),computed:Object(i["a"])({},Object(u["c"])({isLoggedin:"auth/isLoggedin",isReady:"auth/isReady"})),watch:{isLoggedin:function(){if(!this.isLoggedin)return this.$router.push({path:"/login",replace:!0})}}},l=c,s=(n("034f"),n("2877")),h=n("6544"),f=n.n(h),p=n("7496"),d=n("b81c"),m=n("8336"),g=n("a523"),v=n("132d"),b=n("f6c4"),k=Object(s["a"])(l,o,r,!1,null,null,null),j=k.exports;f()(k,{VApp:p["a"],VBottomNavigation:d["a"],VBtn:m["a"],VContainer:g["a"],VIcon:v["a"],VMain:b["a"]});n("d3b7");var w=n("8c4f"),_=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-sheet",[n("p",[t._v("this is Home")]),t._v(" "+t._s(t.basicInformation)+" ")])},y=[],O={name:"Home",data:function(){return{}},mounted:function(){},methods:{},computed:Object(i["a"])({},Object(u["c"])({basicInformation:"auth/basicInformation"}))},S=O,x=n("8dd9"),V=Object(s["a"])(S,_,y,!1,null,null,null),$=V.exports;f()(V,{VSheet:x["a"]});var A=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("p",[t._v("this is Chart")])},T=[],C={name:"Chart",data:function(){return{}},mounted:function(){},methods:{},computed:{}},L=C,q=Object(s["a"])(L,A,T,!1,null,null,null),I=q.exports,P=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-sheet",[n("p",[t._v("this is Setting")]),n("v-btn",{on:{click:t.logout}},[t._v("logout")])],1)},R=[],E={name:"Setting",data:function(){return{}},mounted:function(){},methods:Object(i["a"])({},Object(u["b"])({logout:"auth/logout"})),computed:{}},H=E,B=Object(s["a"])(H,P,R,!1,null,null,null),M=B.exports;f()(B,{VBtn:m["a"],VSheet:x["a"]});var F=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-sheet",{staticClass:"d-flex flex-column justify-center",staticStyle:{height:"100%"}},[n("v-sheet",{staticClass:"d-flex justify-center"},[n("v-btn",{attrs:{href:"https://wallet.ebg.tw/oauth/google/login",color:"primary"}},[n("v-icon",{attrs:{small:"",left:""}},[t._v("mdi-google")]),t._v(" login ")],1)],1)],1)},J=[],z={name:"Home",data:function(){return{}},mounted:function(){if(this.isLoggedin)return this.$router.push({path:"/",replace:!0})},methods:{},computed:Object(i["a"])({},Object(u["c"])({isLoggedin:"auth/isLoggedin"})),watch:{isLoggedin:function(){if(this.isLoggedin)return this.$router.push({path:"/",replace:!0})}}},N=z,U=Object(s["a"])(N,F,J,!1,null,null,null),D=U.exports;f()(U,{VBtn:m["a"],VIcon:v["a"],VSheet:x["a"]});var G=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-sheet",[n("v-card",[n("v-card-title",[t._v("剩下最後一步，填寫你的暱稱吧")]),n("v-card-text",[n("v-text-field",{attrs:{label:"暱稱",placeholder:"暱稱"},model:{value:t.nickname,callback:function(e){t.nickname=e},expression:"nickname"}})],1),n("v-card-actions",[n("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){return t.signup({jwt:t.jwt,nickname:t.nickname})}}},[t._v("註冊")])],1)],1)],1)},K=[],Q=(n("ac1f"),n("5319"),{name:"CallbackSignup",data:function(){return{jwt:"",nickname:""}},mounted:function(){if(!this.$route.query.token)return this.$router.push({path:"/login",replace:!0});this.jwt=this.$route.query.token,this.$router.replace("/callback/signup")},methods:Object(i["a"])({},Object(u["b"])({signup:"auth/signup"})),computed:{}}),W=Q,X=n("b0af"),Y=n("99d9"),Z=n("8654"),tt=Object(s["a"])(W,G,K,!1,null,null,null),et=tt.exports;f()(tt,{VBtn:m["a"],VCard:X["a"],VCardActions:Y["a"],VCardText:Y["b"],VCardTitle:Y["c"],VSheet:x["a"],VTextField:Z["a"]});var nt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("p",[t._v("pending...")])},at=[],ot={name:"CallbackLogin",data:function(){return{}},mounted:function(){var t=this;if(!this.$route.query.token)return this.$router.push({path:"/callback/login",replace:!0});localStorage.setItem("authToken",this.$route.query.token),this.login().then((function(){t.$router.replace("/")}))},methods:Object(i["a"])({},Object(u["b"])({login:"auth/login"})),computed:{}},rt=ot,it=Object(s["a"])(rt,nt,at,!1,null,null,null),ut=it.exports,ct=n("1da1"),lt=(n("96cf"),n("d9e2"),n("bc3a")),st=n.n(lt);st.a.defaults.baseURL="",st.a.defaults.headers.post["Content-Type"]="application/json";var ht=function(t,e,n){var a="Bearer "+(localStorage.getItem("authToken")?localStorage.getItem("authToken"):"");if(void 0!==n)var o=n.params,r=void 0===o?{}:o,i=n.data,u=void 0===i?{}:i;else r=u=null;return new Promise((function(n,o){st()({url:t,method:e,params:r,data:u,headers:{Authorization:a}}).then((function(t){n(t)}),(function(t){o(t)}))}))},ft=ht,pt={namespaced:!0,state:{authToken:"",profile:null,isAuthenticated:!1},mutations:{setAuthToken:function(t,e){t.authToken=e},setProfile:function(t,e){t.profile=e},authenticateSuccess:function(t){t.isAuthenticated=!0},authenticateFail:function(t){t.isAuthenticated=!1},logout:function(t){t.authToken="",t.profile={},t.isAuthenticated=!1}},actions:{login:function(t){return Object(ct["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=t.commit,n("logout"),n("setProfile",null),n("setAuthToken",localStorage.getItem("authToken")),ft("/api/user/profile","get").then((function(t){var e;if(null===(e=t.data)||void 0===e||!e.success)throw new Error(t.data);n("setProfile",t.data.data),n("authenticateSuccess")})).catch((function(t){console.log(t),n("logout")}));case 5:case"end":return e.stop()}}),e)})))()},signup:function(t,e){return Object(ct["a"])(regeneratorRuntime.mark((function n(){var a,o,r,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:a=t.commit,o=t.dispatch,r=e.jwt,i=e.nickname,localStorage.setItem("authToken",r),ft("/api/user/signup","post",{data:{nickname:i}}).then((function(t){var e;if(null===(e=t.data)||void 0===e||!e.success)throw new Error(t.data);o("login")})).catch((function(t){console.log(t),a("logout")}));case 4:case"end":return n.stop()}}),n)})))()},logout:function(t){return Object(ct["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=t.commit,localStorage.clear("authToken"),n("logout");case 3:case"end":return e.stop()}}),e)})))()}},getters:{isLoggedin:function(t){return t.isAuthenticated},isReady:function(t){return null!=t.profile},basicInformation:function(t){var e,n;return{nickname:null===(e=t.profile)||void 0===e?void 0:e.nickname,username:null===(n=t.profile)||void 0===n?void 0:n.username}}}},dt=pt;a["a"].use(u["a"]);var mt=new u["a"].Store({modules:{auth:dt}});a["a"].use(w["a"]);var gt=[{path:"/",name:"Home",component:$,meta:{requiresAuth:!0}},{path:"/chart",name:"Chart",component:I,meta:{requiresAuth:!0}},{path:"/setting",name:"Setting",component:M,meta:{requiresAuth:!0}},{path:"/login",name:"Login",component:D,meta:{requiresAuth:!1}},{path:"/callback/signup",name:"CallbackSignup",component:et,meta:{requiresAuth:!1}},{path:"/callback/login",name:"CallbackLogin",component:ut,meta:{requiresAuth:!1}}],vt=new w["a"]({mode:"history",base:"/",routes:gt});vt.beforeEach((function(t,e,n){var a=mt.getters["auth/isLoggedin"];console.log(a),t.matched.some((function(t){return t.meta.requiresAuth}))?a?n():n({path:"/login"}):n()}));var bt=vt,kt=n("f309");a["a"].use(kt["a"]);var jt=new kt["a"]({});a["a"].config.productionTip=!1,new a["a"]({router:bt,store:mt,vuetify:jt,render:function(t){return t(j)}}).$mount("#app")},"85ec":function(t,e,n){}});
//# sourceMappingURL=app.f866ee6b.js.map