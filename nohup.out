
> gdsc_wallet_backend@1.0.0 start
> nodemon index.js

[33m[nodemon] 2.0.15[39m
[33m[nodemon] to restart at any time, enter `rs`[39m
[33m[nodemon] watching path(s): *.*[39m
[33m[nodemon] watching extensions: js,mjs,json[39m
[32m[nodemon] starting `node index.js`[39m
node:events:498
      throw er; // Unhandled 'error' event
      ^

Error: EBADF: bad file descriptor, read
Emitted 'error' event on ReadStream instance at:
    at emitErrorNT (node:internal/streams/destroy:157:8)
    at errorOrDestroy (node:internal/streams/destroy:220:7)
    at node:internal/fs/streams:258:9
    at FSReqCallback.wrapper [as oncomplete] (node:fs:660:5) {
  errno: -9,
  code: 'EBADF',
  syscall: 'read'
}
Server Running on Port: http://localhost:59001
Successfully connect to mysql : root@localhost 
{
  channel: 'GOOGLE',
  channel_id: '110730829071125524823',
  email: '109703040@g.nccu.edu.tw',
  username: '洪晙宸',
  user_id: 'fBoeto8ZAlCYh+TvEfBc2Fn19cAnnZI8wpRvSn2LP4w=',
  iat: 1652446962,
  exp: 1652533362
}
{
  wallet_id: 'wallet_e8e8fde8-b6a1-46e1-b007-faadd84cb514',
  wallet_name: 'preset_wallet',
  wallet_title: '預設錢包',
  wallet_total: 0,
  wallet_description: '這是預設錢包',
  selected: 0,
  record_num: 0,
  records: []
}
{
  success: true,
  message: '取得使用者資料成功',
  data: {
    user_id: 'fBoeto8ZAlCYh+TvEfBc2Fn19cAnnZI8wpRvSn2LP4w=',
    username: '洪晙宸',
    nickname: 'andyjjrt',
    selected_wallet_id: undefined,
    wallets: [ [Object] ]
  }
}
error : TypeError: Cannot read properties of undefined (reading 'length')
    at auth (file:///home/andyjjrt/GDSC_wallet_backend/middleware/auth.js:12:32)
    at Layer.handle [as handle_request] (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/layer.js:95:5)
    at next (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/route.js:137:13)
    at Route.dispatch (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/route.js:112:3)
    at Layer.handle [as handle_request] (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/layer.js:95:5)
    at /home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:281:22
    at Function.process_params (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:341:12)
    at next (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:275:10)
    at Function.handle (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:174:3)
    at router (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:47:12)
error : TypeError: Cannot read properties of undefined (reading 'length')
    at auth (file:///home/andyjjrt/GDSC_wallet_backend/middleware/auth.js:12:32)
    at Layer.handle [as handle_request] (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/layer.js:95:5)
    at next (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/route.js:137:13)
    at Route.dispatch (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/route.js:112:3)
    at Layer.handle [as handle_request] (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/layer.js:95:5)
    at /home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:281:22
    at Function.process_params (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:341:12)
    at next (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:275:10)
    at Function.handle (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:174:3)
    at router (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:47:12)
error : TypeError: Cannot read properties of undefined (reading 'length')
    at auth (file:///home/andyjjrt/GDSC_wallet_backend/middleware/auth.js:12:32)
    at Layer.handle [as handle_request] (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/layer.js:95:5)
    at next (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/route.js:137:13)
    at Route.dispatch (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/route.js:112:3)
    at Layer.handle [as handle_request] (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/layer.js:95:5)
    at /home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:281:22
    at Function.process_params (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:341:12)
    at next (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:275:10)
    at Function.handle (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:174:3)
    at router (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:47:12)
error : TypeError: Cannot read properties of undefined (reading 'length')
    at auth (file:///home/andyjjrt/GDSC_wallet_backend/middleware/auth.js:12:32)
    at Layer.handle [as handle_request] (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/layer.js:95:5)
    at next (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/route.js:137:13)
    at Route.dispatch (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/route.js:112:3)
    at Layer.handle [as handle_request] (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/layer.js:95:5)
    at /home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:281:22
    at Function.process_params (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:341:12)
    at next (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:275:10)
    at Function.handle (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:174:3)
    at router (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:47:12)
id : iZO3YdJzDrIIt4o/pEP2lAhdasfOPSn3KMIcNIG0HC0=
results : []
user_exist : false
req.user : {
  result: 'USER_NOT_EXIST_IN_DB',
  profile: {
    id: '110435463321763436724',
    displayName: '李順斌',
    name: { familyName: '李', givenName: '順斌' },
    emails: [ [Object] ],
    photos: [ [Object] ],
    provider: 'google',
    _raw: '{\n' +
      '  "sub": "110435463321763436724",\n' +
      '  "name": "李順斌",\n' +
      '  "given_name": "順斌",\n' +
      '  "family_name": "李",\n' +
      '  "picture": "https://lh3.googleusercontent.com/a/AATXAJwYz0golkVEtxol1XriKdtrKAwibJJXC9huCfIG\\u003ds96-c",\n' +
      '  "email": "108703023@g.nccu.edu.tw",\n' +
      '  "email_verified": true,\n' +
      '  "locale": "zh-TW",\n' +
      '  "hd": "g.nccu.edu.tw"\n' +
      '}',
    _json: {
      sub: '110435463321763436724',
      name: '李順斌',
      given_name: '順斌',
      family_name: '李',
      picture: 'https://lh3.googleusercontent.com/a/AATXAJwYz0golkVEtxol1XriKdtrKAwibJJXC9huCfIG=s96-c',
      email: '108703023@g.nccu.edu.tw',
      email_verified: true,
      locale: 'zh-TW',
      hd: 'g.nccu.edu.tw'
    },
    user_id: 'iZO3YdJzDrIIt4o/pEP2lAhdasfOPSn3KMIcNIG0HC0='
  }
}
error : TypeError: Cannot read properties of undefined (reading 'length')
    at auth (file:///home/andyjjrt/GDSC_wallet_backend/middleware/auth.js:12:32)
    at Layer.handle [as handle_request] (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/layer.js:95:5)
    at next (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/route.js:137:13)
    at Route.dispatch (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/route.js:112:3)
    at Layer.handle [as handle_request] (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/layer.js:95:5)
    at /home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:281:22
    at Function.process_params (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:341:12)
    at next (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:275:10)
    at Function.handle (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:174:3)
    at router (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:47:12)
id, channel, channel_id, email, username, nickname : {
  id: 'iZO3YdJzDrIIt4o/pEP2lAhdasfOPSn3KMIcNIG0HC0=',
  channel: 'GOOGLE',
  channel_id: '110435463321763436724',
  email: '108703023@g.nccu.edu.tw',
  username: '李順斌',
  nickname: '李順斌'
}
id: iZO3YdJzDrIIt4o/pEP2lAhdasfOPSn3KMIcNIG0HC0=
channel: GOOGLE
channel_id: 110435463321763436724
email: 108703023@g.nccu.edu.tw
username: 李順斌
nickname: 李順斌
user and default wallet inserted successfully.
user inserted successfully.
{
  channel: 'GOOGLE',
  channel_id: '110435463321763436724',
  email: '108703023@g.nccu.edu.tw',
  username: '李順斌',
  user_id: 'iZO3YdJzDrIIt4o/pEP2lAhdasfOPSn3KMIcNIG0HC0=',
  iat: 1652453025,
  exp: 1652539425
}
{
  wallet_id: 'wallet_ab476db5-d60b-499a-90c5-67e852a0f0c4',
  wallet_name: 'preset_wallet',
  wallet_title: '預設錢包',
  wallet_total: 0,
  wallet_description: '這是預設錢包',
  selected: 1,
  record_num: 0,
  records: []
}
{
  success: true,
  message: '取得使用者資料成功',
  data: {
    user_id: 'iZO3YdJzDrIIt4o/pEP2lAhdasfOPSn3KMIcNIG0HC0=',
    username: '李順斌',
    nickname: '李順斌',
    selected_wallet_id: 'wallet_ab476db5-d60b-499a-90c5-67e852a0f0c4',
    wallets: [ [Object] ]
  }
}
{
  channel: 'GOOGLE',
  channel_id: '110730829071125524823',
  email: '109703040@g.nccu.edu.tw',
  username: '洪晙宸',
  user_id: 'fBoeto8ZAlCYh+TvEfBc2Fn19cAnnZI8wpRvSn2LP4w=',
  iat: 1652446962,
  exp: 1652533362
}
{
  wallet_id: 'wallet_e8e8fde8-b6a1-46e1-b007-faadd84cb514',
  wallet_name: 'preset_wallet',
  wallet_title: '預設錢包',
  wallet_total: 0,
  wallet_description: '這是預設錢包',
  selected: 0,
  record_num: 0,
  records: []
}
{
  success: true,
  message: '取得使用者資料成功',
  data: {
    user_id: 'fBoeto8ZAlCYh+TvEfBc2Fn19cAnnZI8wpRvSn2LP4w=',
    username: '洪晙宸',
    nickname: 'andyjjrt',
    selected_wallet_id: undefined,
    wallets: [ [Object] ]
  }
}
error : TypeError: Cannot read properties of undefined (reading 'length')
    at auth (file:///home/andyjjrt/GDSC_wallet_backend/middleware/auth.js:12:32)
    at Layer.handle [as handle_request] (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/layer.js:95:5)
    at next (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/route.js:137:13)
    at Route.dispatch (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/route.js:112:3)
    at Layer.handle [as handle_request] (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/layer.js:95:5)
    at /home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:281:22
    at Function.process_params (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:341:12)
    at next (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:275:10)
    at Function.handle (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:174:3)
    at router (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:47:12)
error : TypeError: Cannot read properties of undefined (reading 'length')
    at auth (file:///home/andyjjrt/GDSC_wallet_backend/middleware/auth.js:12:32)
    at Layer.handle [as handle_request] (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/layer.js:95:5)
    at next (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/route.js:137:13)
    at Route.dispatch (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/route.js:112:3)
    at Layer.handle [as handle_request] (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/layer.js:95:5)
    at /home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:281:22
    at Function.process_params (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:341:12)
    at next (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:275:10)
    at Function.handle (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:174:3)
    at router (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:47:12)
id : +GwA1CdyJWl3idhnp0MLr6rtmNhmQw39pYxW2W/rQhc=
results : [
  RowDataPacket {
    id: '+GwA1CdyJWl3idhnp0MLr6rtmNhmQw39pYxW2W/rQhc=',
    channel: 'GOOGLE',
    channel_id: '105893969378693204660',
    email: 'andyjjrt@gmail.com',
    username: '紅塵',
    nickname: 'andyjjrt',
    created_time: 2022-05-13T08:11:15.000Z,
    updated_time: 2022-05-13T08:11:15.000Z,
    wallet_num: 1
  }
]
user_exist : true
req.user : {
  result: 'USER_EXIST_IN_DB',
  profile: {
    id: '105893969378693204660',
    displayName: '紅塵',
    name: { familyName: '紅', givenName: '塵' },
    emails: [ [Object] ],
    photos: [ [Object] ],
    provider: 'google',
    _raw: '{\n' +
      '  "sub": "105893969378693204660",\n' +
      '  "name": "紅塵",\n' +
      '  "given_name": "塵",\n' +
      '  "family_name": "紅",\n' +
      '  "picture": "https://lh3.googleusercontent.com/a-/AOh14GiIKQvU3YGm4PNzWbx4SMofDQkkn59twshdMx_gWQ\\u003ds96-c",\n' +
      '  "email": "andyjjrt@gmail.com",\n' +
      '  "email_verified": true,\n' +
      '  "locale": "zh-TW"\n' +
      '}',
    _json: {
      sub: '105893969378693204660',
      name: '紅塵',
      given_name: '塵',
      family_name: '紅',
      picture: 'https://lh3.googleusercontent.com/a-/AOh14GiIKQvU3YGm4PNzWbx4SMofDQkkn59twshdMx_gWQ=s96-c',
      email: 'andyjjrt@gmail.com',
      email_verified: true,
      locale: 'zh-TW'
    },
    user_id: '+GwA1CdyJWl3idhnp0MLr6rtmNhmQw39pYxW2W/rQhc='
  }
}
error : TypeError: Cannot read properties of undefined (reading 'length')
    at auth (file:///home/andyjjrt/GDSC_wallet_backend/middleware/auth.js:12:32)
    at Layer.handle [as handle_request] (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/layer.js:95:5)
    at next (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/route.js:137:13)
    at Route.dispatch (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/route.js:112:3)
    at Layer.handle [as handle_request] (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/layer.js:95:5)
    at /home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:281:22
    at Function.process_params (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:341:12)
    at next (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:275:10)
    at Function.handle (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:174:3)
    at router (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:47:12)
{
  channel: 'GOOGLE',
  channel_id: '105893969378693204660',
  email: 'andyjjrt@gmail.com',
  username: '紅塵',
  user_id: '+GwA1CdyJWl3idhnp0MLr6rtmNhmQw39pYxW2W/rQhc=',
  iat: 1652454579,
  exp: 1652540979
}
{
  wallet_id: 'wallet_20f30c58-cc40-4842-bf0e-79fccb464076',
  wallet_name: 'preset_wallet',
  wallet_title: '預設錢包',
  wallet_total: 0,
  wallet_description: '這是預設錢包',
  selected: 0,
  record_num: 0,
  records: []
}
{
  success: true,
  message: '取得使用者資料成功',
  data: {
    user_id: '+GwA1CdyJWl3idhnp0MLr6rtmNhmQw39pYxW2W/rQhc=',
    username: '紅塵',
    nickname: 'andyjjrt',
    selected_wallet_id: undefined,
    wallets: [ [Object] ]
  }
}
node:events:498
      throw er; // Unhandled 'error' event
      ^

Error: Packets out of order. Got: 0 Expected: 26
    at Parser._tryReadPacketHeader (/home/andyjjrt/GDSC_wallet_backend/node_modules/mysql/lib/protocol/Parser.js:470:15)
    at Parser.write (/home/andyjjrt/GDSC_wallet_backend/node_modules/mysql/lib/protocol/Parser.js:33:29)
    at Protocol.write (/home/andyjjrt/GDSC_wallet_backend/node_modules/mysql/lib/protocol/Protocol.js:38:16)
    at Socket.<anonymous> (/home/andyjjrt/GDSC_wallet_backend/node_modules/mysql/lib/Connection.js:88:28)
    at Socket.<anonymous> (/home/andyjjrt/GDSC_wallet_backend/node_modules/mysql/lib/Connection.js:526:10)
    at Socket.emit (node:events:520:28)
    at addChunk (node:internal/streams/readable:315:12)
    at readableAddChunk (node:internal/streams/readable:289:9)
    at Socket.Readable.push (node:internal/streams/readable:228:10)
    at TCP.onStreamRead (node:internal/stream_base_commons:190:23)
Emitted 'error' event on Connection instance at:
    at Connection._handleProtocolError (/home/andyjjrt/GDSC_wallet_backend/node_modules/mysql/lib/Connection.js:423:8)
    at Protocol.emit (node:events:520:28)
    at Protocol._delegateError (/home/andyjjrt/GDSC_wallet_backend/node_modules/mysql/lib/protocol/Protocol.js:398:10)
    at Protocol.handleParserError (/home/andyjjrt/GDSC_wallet_backend/node_modules/mysql/lib/protocol/Protocol.js:380:10)
    at Parser._tryReadPacketHeader (/home/andyjjrt/GDSC_wallet_backend/node_modules/mysql/lib/protocol/Parser.js:478:10)
    at Parser.write (/home/andyjjrt/GDSC_wallet_backend/node_modules/mysql/lib/protocol/Parser.js:33:29)
    [... lines matching original stack trace ...]
    at Socket.emit (node:events:520:28) {
  code: 'PROTOCOL_PACKETS_OUT_OF_ORDER',
  fatal: true
}
Server Running on Port: http://localhost:59001
Successfully connect to mysql : root@localhost 
error : TypeError: Cannot read properties of undefined (reading 'length')
    at auth (file:///home/andyjjrt/GDSC_wallet_backend/middleware/auth.js:12:32)
    at Layer.handle [as handle_request] (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/layer.js:95:5)
    at next (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/route.js:137:13)
    at Route.dispatch (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/route.js:112:3)
    at Layer.handle [as handle_request] (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/layer.js:95:5)
    at /home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:281:22
    at Function.process_params (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:341:12)
    at next (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:275:10)
    at Function.handle (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:174:3)
    at router (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:47:12)
id : +GwA1CdyJWl3idhnp0MLr6rtmNhmQw39pYxW2W/rQhc=
results : [
  RowDataPacket {
    id: '+GwA1CdyJWl3idhnp0MLr6rtmNhmQw39pYxW2W/rQhc=',
    channel: 'GOOGLE',
    channel_id: '105893969378693204660',
    email: 'andyjjrt@gmail.com',
    username: '紅塵',
    nickname: 'andyjjrt',
    created_time: 2022-05-13T08:11:15.000Z,
    updated_time: 2022-05-13T08:11:15.000Z,
    wallet_num: 1
  }
]
user_exist : true
req.user : {
  result: 'USER_EXIST_IN_DB',
  profile: {
    id: '105893969378693204660',
    displayName: '紅塵',
    name: { familyName: '紅', givenName: '塵' },
    emails: [ [Object] ],
    photos: [ [Object] ],
    provider: 'google',
    _raw: '{\n' +
      '  "sub": "105893969378693204660",\n' +
      '  "name": "紅塵",\n' +
      '  "given_name": "塵",\n' +
      '  "family_name": "紅",\n' +
      '  "picture": "https://lh3.googleusercontent.com/a-/AOh14GiIKQvU3YGm4PNzWbx4SMofDQkkn59twshdMx_gWQ\\u003ds96-c",\n' +
      '  "email": "andyjjrt@gmail.com",\n' +
      '  "email_verified": true,\n' +
      '  "locale": "zh-TW"\n' +
      '}',
    _json: {
      sub: '105893969378693204660',
      name: '紅塵',
      given_name: '塵',
      family_name: '紅',
      picture: 'https://lh3.googleusercontent.com/a-/AOh14GiIKQvU3YGm4PNzWbx4SMofDQkkn59twshdMx_gWQ=s96-c',
      email: 'andyjjrt@gmail.com',
      email_verified: true,
      locale: 'zh-TW'
    },
    user_id: '+GwA1CdyJWl3idhnp0MLr6rtmNhmQw39pYxW2W/rQhc='
  }
}
error : TypeError: Cannot read properties of undefined (reading 'length')
    at auth (file:///home/andyjjrt/GDSC_wallet_backend/middleware/auth.js:12:32)
    at Layer.handle [as handle_request] (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/layer.js:95:5)
    at next (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/route.js:137:13)
    at Route.dispatch (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/route.js:112:3)
    at Layer.handle [as handle_request] (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/layer.js:95:5)
    at /home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:281:22
    at Function.process_params (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:341:12)
    at next (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:275:10)
    at Function.handle (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:174:3)
    at router (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:47:12)
{
  channel: 'GOOGLE',
  channel_id: '105893969378693204660',
  email: 'andyjjrt@gmail.com',
  username: '紅塵',
  user_id: '+GwA1CdyJWl3idhnp0MLr6rtmNhmQw39pYxW2W/rQhc=',
  iat: 1652487268,
  exp: 1652573668
}
{
  wallet_id: 'wallet_20f30c58-cc40-4842-bf0e-79fccb464076',
  wallet_name: 'preset_wallet',
  wallet_title: '預設錢包',
  wallet_total: 0,
  wallet_description: '這是預設錢包',
  selected: 0,
  record_num: 0,
  records: []
}
{
  success: true,
  message: '取得使用者資料成功',
  data: {
    user_id: '+GwA1CdyJWl3idhnp0MLr6rtmNhmQw39pYxW2W/rQhc=',
    username: '紅塵',
    nickname: 'andyjjrt',
    selected_wallet_id: undefined,
    wallets: [ [Object] ]
  }
}
{
  channel: 'GOOGLE',
  channel_id: '105893969378693204660',
  email: 'andyjjrt@gmail.com',
  username: '紅塵',
  user_id: '+GwA1CdyJWl3idhnp0MLr6rtmNhmQw39pYxW2W/rQhc=',
  iat: 1652487268,
  exp: 1652573668
}
{
  wallet_id: 'wallet_20f30c58-cc40-4842-bf0e-79fccb464076',
  wallet_name: 'preset_wallet',
  wallet_title: '預設錢包',
  wallet_total: 0,
  wallet_description: '這是預設錢包',
  selected: 0,
  record_num: 0,
  records: []
}
{
  success: true,
  message: '取得使用者資料成功',
  data: {
    user_id: '+GwA1CdyJWl3idhnp0MLr6rtmNhmQw39pYxW2W/rQhc=',
    username: '紅塵',
    nickname: 'andyjjrt',
    selected_wallet_id: undefined,
    wallets: [ [Object] ]
  }
}
{
  channel: 'GOOGLE',
  channel_id: '105893969378693204660',
  email: 'andyjjrt@gmail.com',
  username: '紅塵',
  user_id: '+GwA1CdyJWl3idhnp0MLr6rtmNhmQw39pYxW2W/rQhc=',
  iat: 1652487268,
  exp: 1652573668
}
{
  wallet_id: 'wallet_20f30c58-cc40-4842-bf0e-79fccb464076',
  wallet_name: 'preset_wallet',
  wallet_title: '預設錢包',
  wallet_total: 0,
  wallet_description: '這是預設錢包',
  selected: 0,
  record_num: 0,
  records: []
}
{
  success: true,
  message: '取得使用者資料成功',
  data: {
    user_id: '+GwA1CdyJWl3idhnp0MLr6rtmNhmQw39pYxW2W/rQhc=',
    username: '紅塵',
    nickname: 'andyjjrt',
    selected_wallet_id: undefined,
    wallets: [ [Object] ]
  }
}
{
  channel: 'GOOGLE',
  channel_id: '105893969378693204660',
  email: 'andyjjrt@gmail.com',
  username: '紅塵',
  user_id: '+GwA1CdyJWl3idhnp0MLr6rtmNhmQw39pYxW2W/rQhc=',
  iat: 1652487268,
  exp: 1652573668
}
{
  wallet_id: 'wallet_20f30c58-cc40-4842-bf0e-79fccb464076',
  wallet_name: 'preset_wallet',
  wallet_title: '預設錢包',
  wallet_total: 0,
  wallet_description: '這是預設錢包',
  selected: 0,
  record_num: 0,
  records: []
}
{
  success: true,
  message: '取得使用者資料成功',
  data: {
    user_id: '+GwA1CdyJWl3idhnp0MLr6rtmNhmQw39pYxW2W/rQhc=',
    username: '紅塵',
    nickname: 'andyjjrt',
    selected_wallet_id: undefined,
    wallets: [ [Object] ]
  }
}
node:events:498
      throw er; // Unhandled 'error' event
      ^

Error: Packets out of order. Got: 0 Expected: 26
    at Parser._tryReadPacketHeader (/home/andyjjrt/GDSC_wallet_backend/node_modules/mysql/lib/protocol/Parser.js:470:15)
    at Parser.write (/home/andyjjrt/GDSC_wallet_backend/node_modules/mysql/lib/protocol/Parser.js:33:29)
    at Protocol.write (/home/andyjjrt/GDSC_wallet_backend/node_modules/mysql/lib/protocol/Protocol.js:38:16)
    at Socket.<anonymous> (/home/andyjjrt/GDSC_wallet_backend/node_modules/mysql/lib/Connection.js:88:28)
    at Socket.<anonymous> (/home/andyjjrt/GDSC_wallet_backend/node_modules/mysql/lib/Connection.js:526:10)
    at Socket.emit (node:events:520:28)
    at addChunk (node:internal/streams/readable:315:12)
    at readableAddChunk (node:internal/streams/readable:289:9)
    at Socket.Readable.push (node:internal/streams/readable:228:10)
    at TCP.onStreamRead (node:internal/stream_base_commons:190:23)
Emitted 'error' event on Connection instance at:
    at Connection._handleProtocolError (/home/andyjjrt/GDSC_wallet_backend/node_modules/mysql/lib/Connection.js:423:8)
    at Protocol.emit (node:events:520:28)
    at Protocol._delegateError (/home/andyjjrt/GDSC_wallet_backend/node_modules/mysql/lib/protocol/Protocol.js:398:10)
    at Protocol.handleParserError (/home/andyjjrt/GDSC_wallet_backend/node_modules/mysql/lib/protocol/Protocol.js:380:10)
    at Parser._tryReadPacketHeader (/home/andyjjrt/GDSC_wallet_backend/node_modules/mysql/lib/protocol/Parser.js:478:10)
    at Parser.write (/home/andyjjrt/GDSC_wallet_backend/node_modules/mysql/lib/protocol/Parser.js:33:29)
    [... lines matching original stack trace ...]
    at Socket.emit (node:events:520:28) {
  code: 'PROTOCOL_PACKETS_OUT_OF_ORDER',
  fatal: true
}
Server Running on Port: http://localhost:59001
Successfully connect to mysql : root@localhost 
error : TypeError: Cannot read properties of undefined (reading 'length')
    at auth (file:///home/andyjjrt/GDSC_wallet_backend/middleware/auth.js:12:32)
    at Layer.handle [as handle_request] (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/layer.js:95:5)
    at next (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/route.js:137:13)
    at Route.dispatch (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/route.js:112:3)
    at Layer.handle [as handle_request] (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/layer.js:95:5)
    at /home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:281:22
    at Function.process_params (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:341:12)
    at next (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:275:10)
    at Function.handle (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:174:3)
    at router (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:47:12)
id : HIvs7NLc/jN16Ud/nSjyo/rB2cqkPjSN41iauwQkD7U=
results : [
  RowDataPacket {
    id: 'HIvs7NLc/jN16Ud/nSjyo/rB2cqkPjSN41iauwQkD7U=',
    channel: 'GOOGLE',
    channel_id: '100762725240858115511',
    email: '108703051@g.nccu.edu.tw',
    username: '謝惟寧',
    nickname: 'test0504',
    created_time: 2022-05-13T06:12:32.000Z,
    updated_time: 2022-05-13T06:12:32.000Z,
    wallet_num: 1
  }
]
user_exist : true
req.user : {
  result: 'USER_EXIST_IN_DB',
  profile: {
    id: '100762725240858115511',
    displayName: '謝惟寧',
    name: { familyName: '謝', givenName: '惟寧' },
    emails: [ [Object] ],
    photos: [ [Object] ],
    provider: 'google',
    _raw: '{\n' +
      '  "sub": "100762725240858115511",\n' +
      '  "name": "謝惟寧",\n' +
      '  "given_name": "惟寧",\n' +
      '  "family_name": "謝",\n' +
      '  "picture": "https://lh3.googleusercontent.com/a-/AOh14GiYVZ4VV89YUMlbwxspIJEJnluiEZmpZGW-23aF\\u003ds96-c",\n' +
      '  "email": "108703051@g.nccu.edu.tw",\n' +
      '  "email_verified": true,\n' +
      '  "locale": "zh-TW",\n' +
      '  "hd": "g.nccu.edu.tw"\n' +
      '}',
    _json: {
      sub: '100762725240858115511',
      name: '謝惟寧',
      given_name: '惟寧',
      family_name: '謝',
      picture: 'https://lh3.googleusercontent.com/a-/AOh14GiYVZ4VV89YUMlbwxspIJEJnluiEZmpZGW-23aF=s96-c',
      email: '108703051@g.nccu.edu.tw',
      email_verified: true,
      locale: 'zh-TW',
      hd: 'g.nccu.edu.tw'
    },
    user_id: 'HIvs7NLc/jN16Ud/nSjyo/rB2cqkPjSN41iauwQkD7U='
  }
}
error : TypeError: Cannot read properties of undefined (reading 'length')
    at auth (file:///home/andyjjrt/GDSC_wallet_backend/middleware/auth.js:12:32)
    at Layer.handle [as handle_request] (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/layer.js:95:5)
    at next (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/route.js:137:13)
    at Route.dispatch (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/route.js:112:3)
    at Layer.handle [as handle_request] (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/layer.js:95:5)
    at /home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:281:22
    at Function.process_params (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:341:12)
    at next (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:275:10)
    at Function.handle (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:174:3)
    at router (/home/andyjjrt/GDSC_wallet_backend/node_modules/express/lib/router/index.js:47:12)
{
  channel: 'GOOGLE',
  channel_id: '100762725240858115511',
  email: '108703051@g.nccu.edu.tw',
  username: '謝惟寧',
  user_id: 'HIvs7NLc/jN16Ud/nSjyo/rB2cqkPjSN41iauwQkD7U=',
  iat: 1652553345,
  exp: 1652639745
}
{
  wallet_id: 'wallet_75e26a02-c1ec-4688-9a5d-1cd913daebf5',
  wallet_name: 'preset_wallet',
  wallet_title: '預設錢包',
  wallet_total: 0,
  wallet_description: '這是預設錢包',
  selected: 0,
  record_num: 0,
  records: []
}
{
  success: true,
  message: '取得使用者資料成功',
  data: {
    user_id: 'HIvs7NLc/jN16Ud/nSjyo/rB2cqkPjSN41iauwQkD7U=',
    username: '謝惟寧',
    nickname: 'test0504',
    selected_wallet_id: undefined,
    wallets: [ [Object] ]
  }
}
{
  channel: 'GOOGLE',
  channel_id: '100762725240858115511',
  email: '108703051@g.nccu.edu.tw',
  username: '謝惟寧',
  user_id: 'HIvs7NLc/jN16Ud/nSjyo/rB2cqkPjSN41iauwQkD7U=',
  iat: 1652553345,
  exp: 1652639745
}
{
  wallet_id: 'wallet_75e26a02-c1ec-4688-9a5d-1cd913daebf5',
  wallet_name: 'preset_wallet',
  wallet_title: '預設錢包',
  wallet_total: 0,
  wallet_description: '這是預設錢包',
  selected: 0,
  record_num: 0,
  records: []
}
{
  success: true,
  message: '取得使用者資料成功',
  data: {
    user_id: 'HIvs7NLc/jN16Ud/nSjyo/rB2cqkPjSN41iauwQkD7U=',
    username: '謝惟寧',
    nickname: 'test0504',
    selected_wallet_id: undefined,
    wallets: [ [Object] ]
  }
}
